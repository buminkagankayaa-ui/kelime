<!DOCTYPE html>
<html lang="tr" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Vocabify</title>
  <meta name="theme-color" content="#0b1220" id="meta-theme">
  <style>
    :root{
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --safe-top: env(safe-area-inset-top, 0px);
      --header-h: 60px;
      --nav-h: 78px;
      --radius: 18px;
      --bg:#0b1220;
      --card:#111b2d;
      --card2:#0f172a;
      --border:#25324a;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --primary:#6366f1;
      --danger:#ef4444;
      --warn:#f59e0b;
      --ok:#10b981;
    }
    [data-theme="light"]{
      --bg:#f8fafc; --card:#ffffff; --card2:#f1f5f9; --border:#cbd5e1;
      --text:#0f172a; --muted:#64748b; --primary:#4f46e5;
      --danger:#dc2626; --warn:#d97706; --ok:#059669;
    }
    [data-theme="ocean"]{ --bg:#06131f; --card:#0b2236; --card2:#0a1b2a; --border:#245070; --text:#e6f2ff; --muted:#9bb7d3; --primary:#38bdf8;}
    [data-theme="emerald"]{ --bg:#071a14; --card:#0b2a21; --card2:#082018; --border:#1f6b52; --text:#ecfdf5; --muted:#9fe3c7; --primary:#10b981;}
    [data-theme="sunset"]{ --bg:#1b1020; --card:#2a1731; --card2:#1f1225; --border:#6b2a59; --text:#fff7ed; --muted:#fbcfe8; --primary:#fb7185;}
    [data-theme="rose"]{ --bg:#120a10; --card:#1f0f1b; --card2:#160b13; --border:#7f1d1d; --text:#fff1f2; --muted:#fda4af; --primary:#f43f5e;}
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Inter",Roboto,system-ui,sans-serif;background:var(--bg);color:var(--text);height:100vh;overflow:hidden;}
    header{
      position:sticky; top:0; z-index:20;
      height:calc(var(--header-h) + var(--safe-top));
      padding-top:var(--safe-top);
      display:flex; align-items:center; justify-content:space-between;
      padding-left:16px; padding-right:16px;
      background:color-mix(in srgb, var(--bg) 78%, transparent);
      backdrop-filter: blur(12px);
      border-bottom:1px solid var(--border);
    }
    .brand{display:flex;align-items:center;gap:10px;font-weight:950;}
    .logo{width:18px;height:18px;border:2px solid var(--primary);border-radius:6px;transform:rotate(15deg);}
    .iconBtn{
      width:44px;height:44px;border-radius:14px;background:transparent;border:1px solid var(--border);
      color:var(--muted);display:grid;place-items:center;cursor:pointer;user-select:none;
    }
    .iconBtn:active{transform:scale(.98);opacity:.9;}
    #viewport{position:relative;height:calc(100vh - (var(--header-h) + var(--safe-top)));}
    .view{
      position:absolute; inset:0;
      padding:18px;
      padding-bottom:calc(var(--nav-h) + var(--safe-bottom) + 18px);
      overflow:auto;
      opacity:0; pointer-events:none;
      transform:translateY(8px);
      transition:.25s ease;
    }
    .view.active{opacity:1; pointer-events:auto; transform:none;}
    .row{display:flex;gap:12px;}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:16px;}
    .muted{color:var(--muted);}
    .big{font-size:34px;font-weight:980;}
    .h2{font-size:20px;font-weight:980;margin:0 0 12px 0;}
    .secTitle{font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:var(--muted);font-weight:950;margin:4px 0 10px;}
    .btn{
      border:0;cursor:pointer;border-radius:16px;padding:14px 16px;font-weight:980;
      display:flex;align-items:center;justify-content:center;gap:10px;user-select:none;
    }
    .btn:active{transform:scale(.985);opacity:.92;}
    .btnPrimary{background:var(--primary);color:white;}
    .btnSoft{background:var(--card2);color:var(--text);border:1px solid var(--border);}
    .btnDanger{background:var(--danger);color:white;}
    .btnOk{background:var(--ok);color:white;}
    .btnHalf{flex:1;}
    nav{
      position:fixed;left:0;right:0;bottom:0;z-index:30;
      height:calc(var(--nav-h) + var(--safe-bottom));
      padding-bottom:var(--safe-bottom);
      background:var(--card2);
      border-top:1px solid var(--border);
      display:flex;
    }
    .navBtn{
      flex:1;background:transparent;border:0;color:var(--muted);
      cursor:pointer;user-select:none;
      display:grid;grid-template-rows:36px 18px;
      align-items:center;justify-items:center;
      padding:6px 0;line-height:1;min-width:0;
    }
    .navBtn .ico{width:46px;height:36px;display:grid;place-items:center;font-size:20px;line-height:1;}
    .navBtn span{font-size:11.5px;font-weight:980;line-height:1;transform:translateY(-1px);white-space:nowrap;}
    .navBtn.active{color:var(--primary);}
    .navBtn.active .ico{background:color-mix(in srgb, var(--primary) 15%, transparent);border-radius:14px;}
    .backdrop{position:fixed;inset:0;z-index:40;background:rgba(0,0,0,.55);opacity:0;pointer-events:none;transition:.2s ease;}
    .backdrop.open{opacity:1;pointer-events:auto;}
    .sheet{
      position:fixed;left:0;right:0;bottom:0;z-index:50;
      background:var(--card);
      border-radius:26px 26px 0 0;
      border:1px solid var(--border);
      transform:translateY(110%);
      transition:.25s ease;
      max-height:85vh;overflow:auto;
      padding:14px 16px calc(16px + var(--safe-bottom));
    }
    .sheet.open{transform:none;}
    .handle{width:48px;height:5px;border-radius:99px;background:var(--border);margin:6px auto 14px;}
    .field{margin:10px 0;}
    label{display:block;font-size:12px;font-weight:980;color:var(--muted);margin-bottom:6px;}
    input, textarea, select{
      width:100%;background:var(--card2);border:1px solid var(--border);border-radius:16px;
      padding:14px;color:var(--text);font-size:16px;outline:none;
    }
    textarea{min-height:92px;resize:none;}
    .two{display:flex;gap:10px;}
    .smallInfo{font-size:12px;color:var(--muted);font-weight:950;margin-top:6px;}
    .toast{
      position:fixed;left:50%;top:calc(14px + var(--safe-top));
      transform:translate(-50%,-20px);
      background:var(--text);color:var(--bg);
      padding:10px 14px;border-radius:99px;font-weight:980;
      opacity:0;pointer-events:none;transition:.25s ease;z-index:200;
      max-width:calc(100vw - 20px);text-align:center;
    }
    .toast.show{opacity:1;transform:translate(-50%,0);}
    .cardLine{display:flex;justify-content:space-between;align-items:center;gap:10px;}
    .termBig{font-weight:980;color:var(--primary);font-size:20px;}
    .badge{
      font-size:11px;font-weight:980;padding:6px 10px;border-radius:999px;border:1px solid var(--border);
      color:var(--muted);background:color-mix(in srgb, var(--card2) 60%, transparent);white-space:nowrap;
    }
    .badge.due{color:var(--warn);border-color:color-mix(in srgb, var(--warn) 45%, var(--border));background:color-mix(in srgb, var(--warn) 10%, transparent);}
    .divider{height:1px;background:var(--border);margin:12px 0;}
    .kbd{font-size:11px;font-weight:980;border:1px solid var(--border);padding:4px 8px;border-radius:10px;background:var(--card);color:var(--muted);}

    /* Quiz overlay (simple) */
    .overlay{position:fixed;inset:0;z-index:120;background:var(--bg);transform:translateX(110%);transition:.25s ease;display:flex;flex-direction:column;}
    .overlay.open{transform:none;}
    .overlayTop{
      display:flex;align-items:center;justify-content:space-between;
      padding:14px 16px calc(14px + var(--safe-top));
      padding-top:calc(14px + var(--safe-top));
      border-bottom:1px solid var(--border);
      background:color-mix(in srgb, var(--bg) 85%, transparent);
      backdrop-filter: blur(12px);
    }
    .qChoice{ text-align:left;background:var(--card);border:1px solid var(--border);padding:14px;border-radius:16px;cursor:pointer;font-weight:950;}
    .qChoice.correct{border-color:color-mix(in srgb, var(--ok) 70%, var(--border));background:color-mix(in srgb, var(--ok) 12%, var(--card));}
    .qChoice.wrong{border-color:color-mix(in srgb, var(--danger) 70%, var(--border));background:color-mix(in srgb, var(--danger) 10%, var(--card));}
  </style>
</head>

<body>
<header>
  <div class="brand"><div class="logo"></div><div>Vocabify</div></div>
  <div style="display:flex; gap:10px;">
    <button class="iconBtn" id="btnTheme">ğŸ¨</button>
    <button class="iconBtn" id="btnSettings">âš™ï¸</button>
  </div>
</header>

<div id="viewport">
  <section class="view active" id="home">
    <div class="secTitle">Genel BakÄ±ÅŸ</div>
    <div class="row" style="gap:10px; margin-bottom:14px;">
  
  <div class="card" style="flex:1; border:1px solid var(--primary); padding:10px;">
    <div style="font-weight:bold; color:var(--primary); font-size:12px; margin-bottom:6px;">ğŸ‡¬ğŸ‡§ Ä°ngilizce â¡ï¸ ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e</div>
    <div style="display:flex; gap:6px;">
      <input id="quickTransInput" placeholder="Ä°ngilizce yaz..." style="background:var(--bg); font-size:13px;" onkeydown="if(event.key==='Enter') doQuickTranslate()" />
      <button class="iconBtn" style="background:var(--primary); color:white; border:none; width:36px; height:36px;" onclick="doQuickTranslate()">ğŸ”</button>
    </div>
  </div>

  <div class="card" style="flex:1; border:1px solid var(--warn); padding:10px;">
    <div style="font-weight:bold; color:var(--warn); font-size:12px; margin-bottom:6px;">ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e â¡ï¸ ğŸ‡¬ğŸ‡§ Ä°ngilizce</div>
    <div style="display:flex; gap:6px;">
      <input id="quickTransInputTR" placeholder="TÃ¼rkÃ§e yaz..." style="background:var(--bg); font-size:13px;" onkeydown="if(event.key==='Enter') doQuickTranslateTR()" />
      <button class="iconBtn" style="background:var(--warn); color:white; border:none; width:36px; height:36px;" onclick="doQuickTranslateTR()">ğŸ”</button>
    </div>
  </div>
</div>
    <div class="row">
      <div class="card" style="flex:1;">
        <div class="muted" style="font-weight:980;">Toplam Kart</div>
        <div class="big" id="dashTotal">0</div>
      </div>
      <div class="card" style="flex:1; border-color:color-mix(in srgb, var(--warn) 45%, var(--border));">
        <div style="font-weight:980; color:var(--warn);">Tekrar</div>
        <div class="big" style="color:var(--warn);" id="dashDue">0</div>
      </div>
    </div>

    <div class="card" style="margin-top:14px;">
      <div style="font-weight:980;">HÄ±zlÄ± Ä°ÅŸlemler</div>
      <div class="two" style="margin-top:12px;">
        <button class="btn btnPrimary btnHalf" onclick="go('review')">ğŸ§  Tekrar</button>
        <button class="btn btnSoft btnHalf" onclick="go('cards')">ğŸ—‚ï¸ Kartlar</button>
      </div>
      <div class="two" style="margin-top:10px;">
        <button class="btn btnSoft btnHalf" onclick="openManualAdd()">â• Elle Kelime Ekle</button>
        <button class="btn btnSoft btnHalf" onclick="resetTodaysQueue()">ğŸ” KuyruÄŸu Yenile</button>
      </div>
      <div class="two" style="margin-top:10px;">
   <button class="btn btnPrimary" style="width:100%;" onclick="openSheet('grammarSheet')">ğŸ“˜ HÄ±zlÄ± Gramer KitapÃ§Ä±ÄŸÄ±</button>
</div>
    </div>
  </section>

  <section class="view" id="review">
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <h2 class="h2">Tekrar</h2>
      <button class="btn btnSoft" style="padding:10px 12px; border-radius:14px;" onclick="startReviewQuiz()">BaÅŸlat</button>
    </div>

    <div class="card">
      <div style="font-weight:980;">BugÃ¼n tekrar edilecek kartlar</div>
      <div class="smallInfo">ZamanÄ± gelen kartlar Ã¶ncelikli gelir. Yoksa rastgele pratik aÃ§Ä±lÄ±r.</div>

      <div style="display:flex; gap:10px; margin-top:12px;">
        <div class="card" style="flex:1; padding:12px;">
          <div class="smallInfo">SÄ±radaki</div>
          <div class="big" id="rvDue">0</div>
        </div>
        <div class="card" style="flex:1; padding:12px;">
          <div class="smallInfo">Toplam</div>
          <div class="big" id="rvTotal">0</div>
        </div>
      </div>

      <div class="two" style="margin-top:12px;">
        <div style="font-weight:bold; margin-bottom:8px; color:var(--text); margin-top:10px;">KaÃ§ kart Ã§alÄ±ÅŸacaksÄ±n?</div>
<div style="display:grid; grid-template-columns: repeat(5, 1fr); gap:6px; margin-bottom:14px;">
  <button class="btn btnSoft" onclick="startReviewQuiz(5)">5</button>
  <button class="btn btnSoft" onclick="startReviewQuiz(10)">10</button>
  <button class="btn btnSoft" onclick="startReviewQuiz(15)">15</button>
  <button class="btn btnSoft" onclick="startReviewQuiz(20)">20</button>
  <button class="btn btnPrimary" onclick="startReviewQuiz(9999)">Hepsi</button>
</div>
        <button class="btn btnSoft btnHalf" onclick="toggleQuizMode()">Mod: <span id="quizModeLabel">SeÃ§meli</span></button>
      </div>

      <div class="divider"></div>

      <div class="two">
        <button class="btn btnSoft btnHalf" onclick="clearProgress()">â™»ï¸ SRS SÄ±fÄ±rla</button>
        <button class="btn btnSoft btnHalf" onclick="toast('Online AutoFill aktif âœ…')">Durum</button>
      </div>
    </div>
  </section>

  <section class="view" id="cards">
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <h2 class="h2">Kartlar</h2>
      <button class="btn btnSoft" style="padding:10px 12px; border-radius:14px;" onclick="openManualAdd()">â• Ekle</button>
    </div>

    <div class="card" style="margin-bottom:12px;">
      <input id="search" placeholder="Kart ara (kelime/anlam/tÃ¼r)..." />
      <div class="smallInfo" style="margin-top:8px;">KartÄ± aÃ§ â†’ dÃ¼zenle / sil.</div>
    </div>

    <div id="cardsList"></div>
  </section>
</div>

<nav>
  <button class="navBtn active" id="navHome" onclick="go('home')"><div class="ico">ğŸ </div><span>Ana Sayfa</span></button>
  <button class="navBtn" id="navReview" onclick="go('review')"><div class="ico">ğŸ§ </div><span>Tekrar</span></button>
  <button class="navBtn" id="navCards" onclick="go('cards')"><div class="ico">ğŸ—‚ï¸</div><span>Kartlar</span></button>
</nav>

<div class="backdrop" id="backdrop" onclick="closeSheets()"></div>
<div class="toast" id="toast">â€”</div>

<!-- Manual Add -->
<div class="sheet" id="manualAddSheet">
  <div class="handle"></div>
  <h2 class="h2">Elle Kelime Ekle (Online Otomatik)</h2>

  <div class="field">
    <label>Dil</label>
    <select id="maLang">
      <option value="EN">Ä°ngilizce</option>
      <option value="RU">RusÃ§a</option>
      <option value="DE">Almanca</option>
      <option value="ES">Ä°spanyolca</option> <option value="FR">FransÄ±zca</option>
      <option value="TR">TÃ¼rkÃ§e</option>
    </select>
  </div>
  <div class="field">
    <label>Kelime / Terim</label>
    <input id="maTerm" placeholder="Ã–rn: reinforcement" />
    <div class="smallInfo" id="maHint">YazÄ±nca otomatik doldurur. Ä°nternet ÅŸart.</div>
  </div>

  <div class="field">
    <label>AnlamÄ± (TR) - (Ã‡oklu Anlam)</label>
    <textarea id="maMeaning" placeholder="Otomatik dolacak (Ã‡oklu anlam)" style="min-height:60px; font-family:inherit; background:var(--card2); border:1px solid var(--border); border-radius:16px; width:100%; padding:14px; color:var(--text);"></textarea>
  </div>

  <div class="field">
    <label>TÃ¼r</label>
    <select id="maType">
      <option value="word">Kelime</option>
      <option value="phrase">KalÄ±p</option>
      <option value="idiom">Deyim</option>
      <option value="phrasal">Phrasal Verb</option>
      <option value="noun">Ä°sim</option>
      <option value="verb">Fiil</option>
      <option value="adj">SÄ±fat</option>
      <option value="adv">Zarf</option>
    </select>
  </div>

  <div class="field">
    <label>Ã–rnek CÃ¼mle</label>
    <textarea id="maExample" placeholder="Otomatik dolacak"></textarea>
  </div>

  <div class="field">
    <label>Not (opsiyonel)</label>
    <input id="maNote" placeholder="Ä°pucu/Not" />
  </div>

  <div class="two" style="margin-top:10px;">
    <button class="btn btnSoft btnHalf" onclick="closeSheets()">VazgeÃ§</button>
    <button class="btn btnSoft btnHalf" onclick="autoFillManualFields(true)">âš¡ Doldur</button>
  </div>
  <div class="two" style="margin-top:10px;">
    <button class="btn btnPrimary btnHalf" onclick="saveManualCard()">Kaydet</button>
    <button class="btn btnDanger btnHalf" onclick="clearManual()">Temizle</button>
  </div>
</div>

<!-- Settings -->
<div class="sheet" id="settingsSheet">
  <div class="handle"></div>
  <h2 class="h2">Ayarlar</h2>

  <div class="card" style="margin-top:10px;">
    <div style="font-weight:980;">Tema</div>
    <div class="two" style="margin-top:10px;">
      <select id="themeSelect" onchange="applyThemeFromSelect()">
        <option value="dark">dark</option>
        <option value="light">light</option>
        <option value="ocean">ocean</option>
        <option value="emerald">emerald</option>
        <option value="sunset">sunset</option>
        <option value="rose">rose</option>
      </select>
      <button class="btn btnSoft" style="padding:12px 12px;" onclick="document.getElementById('btnTheme').click()">DÃ¶ndÃ¼r</button>
    </div>
  </div>

  <div class="card" style="margin-top:12px;">
    <div style="font-weight:980;">Quiz Modu</div>
    <div class="two" style="margin-top:10px;">
      <button class="btn btnSoft btnHalf" onclick="toggleQuizMode()">Mod: <span id="quizModeLabel2">SeÃ§meli</span></button>
      <button class="btn btnSoft btnHalf" onclick="exportAll()">Export</button>
    </div>
    <div class="two" style="margin-top:10px;">
      <button class="btn btnSoft btnHalf" onclick="importAllPrompt()">Import</button>
      <button class="btn btnDanger btnHalf" onclick="hardReset()">SÄ±fÄ±rla</button>
    </div>
  </div>

  <div class="smallInfo" style="margin-top:12px;">SÃ¼rÃ¼m: online-autofill â€¢ dictionary + translate â€¢ no level/category</div>
</div>

<!-- Quiz overlay -->
  <div class="sheet" id="transResultSheet" style="height:auto; max-height:80vh;">
  <div class="handle"></div>
  <h2 class="h2">Ã‡eviri Sonucu</h2>
  
  <div id="trResContent" style="line-height:1.6;"></div>

  <button class="btn btnPrimary" style="width:100%; margin-top:16px;" onclick="copyToManualAdd()">â• Bu Kelimeyi Karta Ekle</button>
  <button class="btn btnSoft" style="width:100%; margin-top:10px;" onclick="closeSheets()">Kapat</button>
</div>
  <div class="sheet" id="grammarSheet" style="height:90vh;">
  <div class="handle"></div>
  <h2 class="h2" style="color:var(--primary); text-align:center;">ğŸ“˜ Ä°ngilizce Ä°puÃ§larÄ±</h2>

  <div class="card" style="margin-bottom:14px; padding:0; overflow:hidden; border:1px solid var(--border);">
    <div style="background:var(--card2); padding:10px; font-weight:900; border-bottom:1px solid var(--border); text-align:center;">ğŸ‘¤ Zamirler (Pronouns)</div>
    <table style="width:100%; border-collapse:collapse; font-size:12px; text-align:center;">
      <tr style="background:color-mix(in srgb, var(--primary) 15%, transparent); font-weight:bold;">
        <td style="padding:6px;">Ben</td>
        <td style="padding:6px;">Beni</td>
        <td style="padding:6px;">Benim</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:6px; font-weight:bold; color:var(--primary);">I</td>
        <td style="padding:6px;">Me</td>
        <td style="padding:6px;">My</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:6px; font-weight:bold; color:var(--primary);">You</td>
        <td style="padding:6px;">You</td>
        <td style="padding:6px;">Your</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:6px; font-weight:bold; color:var(--primary);">He/She</td>
        <td style="padding:6px;">Him/Her</td>
        <td style="padding:6px;">His/Her</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:6px; font-weight:bold; color:var(--primary);">We</td>
        <td style="padding:6px;">Us</td>
        <td style="padding:6px;">Our</td>
      </tr>
      <tr>
        <td style="padding:6px; font-weight:bold; color:var(--primary);">They</td>
        <td style="padding:6px;">Them</td>
        <td style="padding:6px;">Their</td>
      </tr>
    </table>
  </div>

  <div class="card" style="margin-bottom:14px; padding:0; overflow:hidden; border:1px solid var(--border);">
    <div style="background:var(--card2); padding:10px; font-weight:900; border-bottom:1px solid var(--border); text-align:center;">â³ Zamanlar (Tenses)</div>
    <table style="width:100%; border-collapse:collapse; font-size:13px;">
      <tr style="background:color-mix(in srgb, var(--primary) 15%, transparent);">
        <th style="padding:6px; text-align:left;">Zaman</th>
        <th style="padding:6px; text-align:left;">Ä°pucu</th>
        <th style="padding:6px; text-align:left;">Ã–rnek</th>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:6px; font-weight:bold;">Genel</td>
        <td style="padding:6px; color:var(--muted);">Her gÃ¼n</td>
        <td style="padding:6px;">I <b style="color:var(--primary)">play</b>.</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:6px; font-weight:bold;">Åimdiki</td>
        <td style="padding:6px; color:var(--muted);">Åu an</td>
        <td style="padding:6px;">I am <b style="color:var(--primary)">playing</b>.</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:6px; font-weight:bold;">GeÃ§miÅŸ</td>
        <td style="padding:6px; color:var(--muted);">DÃ¼n</td>
        <td style="padding:6px;">I <b style="color:var(--primary)">played</b>.</td>
      </tr>
      <tr>
        <td style="padding:6px; font-weight:bold;">Gelecek</td>
        <td style="padding:6px; color:var(--muted);">YarÄ±n</td>
        <td style="padding:6px;">I <b style="color:var(--primary)">will play</b>.</td>
      </tr>
    </table>
  </div>

  <div class="card" style="margin-bottom:14px;">
    <div style="font-weight:900; color:var(--warn); margin-bottom:10px; text-align:center;">ğŸ› ï¸ Modals (Kip Ekleri)</div>
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:8px;">
      <div style="background:var(--bg); padding:8px; border-radius:8px; border:1px dashed var(--border);">
        <div style="font-weight:bold; color:var(--primary);">CAN</div>
        <div style="font-size:11px;">-ebilmek (Yetenek)</div>
      </div>
      <div style="background:var(--bg); padding:8px; border-radius:8px; border:1px dashed var(--border);">
        <div style="font-weight:bold; color:var(--primary);">SHOULD</div>
        <div style="font-size:11px;">-meli (Tavsiye)</div>
      </div>
      <div style="background:var(--bg); padding:8px; border-radius:8px; border:1px dashed var(--border);">
        <div style="font-weight:bold; color:var(--primary);">MUST</div>
        <div style="font-size:11px;">-meli (Zorunlu)</div>
      </div>
      <div style="background:var(--bg); padding:8px; border-radius:8px; border:1px dashed var(--border);">
        <div style="font-weight:bold; color:var(--primary);">MIGHT</div>
        <div style="font-size:11px;">-ebilir (Ä°htimal)</div>
      </div>
    </div>
  </div>

  <div class="card" style="margin-bottom:14px; padding:0; overflow:hidden; border:1px solid var(--border);">
    <div style="background:var(--card2); padding:10px; font-weight:900; border-bottom:1px solid var(--border); text-align:center;">â“ Soru Kelimeleri (Wh- Questions)</div>
    <table style="width:100%; border-collapse:collapse; font-size:13px; text-align:center;">
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:8px; font-weight:bold; color:var(--primary);">WHO</td>
        <td style="padding:8px;">Kim?</td>
        <td style="padding:8px; font-style:italic; color:var(--muted);">Who are you?</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:8px; font-weight:bold; color:var(--primary);">WHAT</td>
        <td style="padding:8px;">Ne?</td>
        <td style="padding:8px; font-style:italic; color:var(--muted);">What is this?</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:8px; font-weight:bold; color:var(--primary);">WHERE</td>
        <td style="padding:8px;">Nerede?</td>
        <td style="padding:8px; font-style:italic; color:var(--muted);">Where is Ali?</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:8px; font-weight:bold; color:var(--primary);">WHEN</td>
        <td style="padding:8px;">Ne zaman?</td>
        <td style="padding:8px; font-style:italic; color:var(--muted);">When do we go?</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:8px; font-weight:bold; color:var(--primary);">WHY</td>
        <td style="padding:8px;">Neden?</td>
        <td style="padding:8px; font-style:italic; color:var(--muted);">Why are you sad?</td>
      </tr>
      <tr>
        <td style="padding:8px; font-weight:bold; color:var(--primary);">HOW</td>
        <td style="padding:8px;">NasÄ±l?</td>
        <td style="padding:8px; font-style:italic; color:var(--muted);">How are you?</td>
      </tr>
    </table>
  </div>

  <div class="card" style="margin-bottom:14px;">
    <div style="font-weight:900; color:var(--warn); margin-bottom:10px; text-align:center;">ğŸ A - AN - THE FarkÄ±</div>
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:8px;">
      <div style="background:var(--bg); padding:10px; border-radius:8px; border:1px dashed var(--border);">
        <div style="font-weight:bold; color:var(--primary); font-size:16px;">A / AN</div>
        <div style="font-size:11px; margin-top:2px; font-weight:bold;">HERHANGÄ° BÄ°R</div>
        <div style="font-size:11px; margin-top:4px; color:var(--muted);">
          Bilinmeyen ÅŸeylerde.<br>
          ğŸ‘‰ <b>a</b> car (bir araba)<br>
          ğŸ‘‰ <b>an</b> apple (bir elma)
        </div>
      </div>
      <div style="background:var(--bg); padding:10px; border-radius:8px; border:1px dashed var(--border);">
        <div style="font-weight:bold; color:var(--primary); font-size:16px;">THE</div>
        <div style="font-size:11px; margin-top:2px; font-weight:bold;">BÄ°LÄ°NEN O ÅEY</div>
        <div style="font-size:11px; margin-top:4px; color:var(--muted);">
          KonuÅŸulan belirli ÅŸey.<br>
          ğŸ‘‰ <b>the</b> moon (ay)<br>
          ğŸ‘‰ <b>the</b> door (o kapÄ±)
        </div>
      </div>
    </div>
  </div>

  <div class="card" style="margin-bottom:14px; padding:0; overflow:hidden; border:1px solid var(--border);">
    <div style="background:var(--card2); padding:10px; font-weight:900; border-bottom:1px solid var(--border); text-align:center;">ğŸ“ SÄ±fatlar (KarÅŸÄ±laÅŸtÄ±rma)</div>
    <table style="width:100%; border-collapse:collapse; font-size:13px; text-align:center;">
      <tr style="background:color-mix(in srgb, var(--primary) 15%, transparent);">
        <th style="padding:6px;">SÄ±fat</th>
        <th style="padding:6px;">Daha ...</th>
        <th style="padding:6px;">En ...</th>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:6px;">Big (BÃ¼yÃ¼k)</td>
        <td style="padding:6px; font-weight:bold;">Big<span style="color:var(--warn)">ger</span></td>
        <td style="padding:6px; font-weight:bold;">The Big<span style="color:var(--warn)">gest</span></td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:6px;">Fast (HÄ±zlÄ±)</td>
        <td style="padding:6px; font-weight:bold;">Fast<span style="color:var(--warn)">er</span></td>
        <td style="padding:6px; font-weight:bold;">The Fast<span style="color:var(--warn)">est</span></td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:6px;">Good (Ä°yi)</td>
        <td style="padding:6px; font-weight:bold; color:var(--ok);">Better</td>
        <td style="padding:6px; font-weight:bold; color:var(--ok);">The Best</td>
      </tr>
      <tr>
        <td style="padding:6px;">Bad (KÃ¶tÃ¼)</td>
        <td style="padding:6px; font-weight:bold; color:var(--warn);">Worse</td>
        <td style="padding:6px; font-weight:bold; color:var(--warn);">The Worst</td>
      </tr>
    </table>
  </div>

  <button class="btn btnSoft" style="width:100%; margin-top:20px;" onclick="closeSheets()">Kapat</button>
</div>
  <div class="overlay" id="quizOverlay">
  <div class="overlayTop">
    <div style="font-weight:980;">Quiz</div>
    <button class="iconBtn" onclick="stopQuiz()">Ã—</button>
  </div>
  <div id="quizBody" style="padding:18px;">
    <div class="card" style="padding:12px;">
      <div class="smallInfo">Kalan: <b id="qRemain">0</b>/<b id="qTotal">0</b> â€¢ âœ… <b id="qCorrect">0</b> â€¢ âŒ <b id="qWrong">0</b></div>
      <div style="margin-top:10px; font-size:40px; font-weight:1000; text-align:center;" id="qWord">â€”</div>
      <div class="smallInfo" style="text-align:center; margin-top:8px;" id="qMeta">â€”</div>
      <div style="text-align:center; font-style:italic; color:var(--primary); margin-top:6px; min-height:20px;" id="qExample"></div>
    </div>

    <div id="qChoices" style="margin-top:12px; display:flex; flex-direction:column; gap:10px;"></div>

    <div id="qTyping" style="margin-top:12px; display:none; gap:10px;">
      <input id="qInput" placeholder="AnlamÄ±nÄ± yaz..." style="flex:1; font-weight:950;" />
      <button class="btn btnPrimary" style="padding:12px 14px;" onclick="checkTypingAnswer()">Kontrol</button>
    </div>

    <div class="smallInfo" id="qReveal" style="text-align:center; margin-top:10px; min-height:18px;"></div>

    <div class="two" style="margin-top:12px;">
      <button class="btn btnSoft btnHalf" onclick="skipQuestion()">â­ï¸ GeÃ§</button>
    </div>

    <div class="smallInfo" style="text-align:center; margin-top:10px;">
      <span class="kbd">Enter</span> kontrol (yazmalÄ±) â€¢ <span class="kbd">Esc</span> Ã§Ä±kÄ±ÅŸ
    </div>
  </div>
</div>

<script>
/* ===========================
   Storage + helpers
=========================== */
const DB = {
  get(key, fallback){ try { return JSON.parse(localStorage.getItem(key)) ?? fallback; } catch { return fallback; } },
  set(key, val){ localStorage.setItem(key, JSON.stringify(val)); }
};
function toast(msg){
  const t=document.getElementById("toast");
  t.textContent=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"), 2200);
}
function now(){ return Date.now(); }
function norm(s){ return (s||"").toLowerCase().trim(); }
function uid(){ return "c_" + Math.random().toString(36).slice(2) + "_" + Math.random().toString(36).slice(2); }
function safeText(s){ return (s ?? "").toString(); }

/* ===========================
   State
=========================== */
const themes=["dark","light","ocean","emerald","sunset","rose"];
const state = {
  settings: DB.get("lm_settings", { theme:"dark", quizMode:"choice" }), // choice|typing
  cards: DB.get("lm_cards", []),
  txCache: DB.get("lm_tx_cache", {}),        // cache for translations
  dictCache: DB.get("lm_dict_cache", {}),    // cache for dictionary results (EN)
  reviewQueue: DB.get("lm_review_queue", [])
};
function saveAll(){
  DB.set("lm_settings", state.settings);
  DB.set("lm_cards", state.cards);
  DB.set("lm_tx_cache", state.txCache);
  DB.set("lm_dict_cache", state.dictCache);
  DB.set("lm_review_queue", state.reviewQueue);
}

/* ===========================
   Theme
=========================== */
function setTheme(name){
  document.documentElement.setAttribute("data-theme", name);
  state.settings.theme = name;
  DB.set("lm_settings", state.settings);
  const meta=document.getElementById("meta-theme");
  meta.setAttribute("content", getComputedStyle(document.documentElement).getPropertyValue("--bg").trim() || "#0b1220");
  const sel=document.getElementById("themeSelect"); if(sel) sel.value=name;
}
function applyThemeFromSelect(){ setTheme(document.getElementById("themeSelect").value); toast("Tema gÃ¼ncellendi"); }
document.getElementById("btnTheme").onclick=()=>{
  const idx=(themes.indexOf(state.settings.theme)+1)%themes.length;
  setTheme(themes[idx]); toast("Tema: " + themes[idx]);
};
document.getElementById("btnSettings").onclick=()=>{
  document.getElementById("themeSelect").value = state.settings.theme;
  syncQuizModeLabels();
  openSheet("settingsSheet");
};

/* ===========================
   Router
=========================== */
function go(id){
  document.querySelectorAll(".view").forEach(v=>v.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll(".navBtn").forEach(b=>b.classList.remove("active"));
  if(id==="home") document.getElementById("navHome").classList.add("active");
  if(id==="review") document.getElementById("navReview").classList.add("active");
  if(id==="cards") document.getElementById("navCards").classList.add("active");
  if(id==="home") renderDash();
  if(id==="review") renderReview();
  if(id==="cards") renderCards();
}

/* ===========================
   Sheets
=========================== */
const backdrop=document.getElementById("backdrop");
function openSheet(id){ backdrop.classList.add("open"); document.getElementById(id).classList.add("open"); }
function closeSheets(){ backdrop.classList.remove("open"); document.querySelectorAll(".sheet").forEach(s=>s.classList.remove("open")); }
window.addEventListener("keydown",(e)=>{
  if(e.key==="Escape"){
    if(document.getElementById("quizOverlay").classList.contains("open")) stopQuiz();
    else closeSheets();
  }
});

/* ===========================
   ONLINE: Translate (meaning TR)
   - uses Google translate gtx (works in browser)
=========================== */
/* ===========================
   1. GELÄ°ÅMÄ°Å Ã‡EVÄ°RÄ° MOTORU (DetaylÄ± Anlam Ã‡eker)
=========================== */
async function translateToTR(lang, term){
  const key = `${lang}|${norm(term)}`;
  if(state.txCache[key]) return state.txCache[key];

  // Dil ayarÄ± (HÄ±zlÄ± Ã§eviri iÃ§in 'auto' gelirse EN varsayalÄ±m veya Google'a bÄ±rakalÄ±m)
  const sl = ({EN:"en", RU:"ru", DE:"de", FR:"fr", ES:"es", TR:"tr"})[lang] || "auto";
  
  // Google API (DetaylÄ± mod: dt=t ana Ã§eviri, dt=bd sÃ¶zlÃ¼k/eÅŸ anlamlÄ±lar)
  const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=${sl}&tl=tr&dt=t&dt=bd&q=${encodeURIComponent(term)}`;

  try{
    const r = await fetch(url);
    if(!r.ok) throw new Error("fail");
    const data = await r.json();

    // 1. Ana Ã‡eviri
    let mainMean = (data?.[0]?.[0]?.[0] || "").trim();

    // 2. DetaylÄ± Anlamlar (Varsa: Ä°sim, Fiil kategorileri)
    let extraMeans = [];
    if(data[1]){
      data[1].forEach(group => {
        const pos = group[0]; // tÃ¼r (noun/verb)
        // O tÃ¼rdeki ilk 5 anlamÄ± alÄ±p birleÅŸtir
        const words = group[1].slice(0, 5).join(", "); 
        extraMeans.push(`[${pos}]: ${words}`);
      });
    }

    // Hepsini birleÅŸtir
    let finalResult = mainMean;
    if(extraMeans.length > 0){
      // Alt satÄ±ra detaylarÄ± ekle
      finalResult = mainMean + "\n\n(" + extraMeans.join(") \n(") + ")";
    }

    // HafÄ±zaya kaydet ve dÃ¶ndÃ¼r
    state.txCache[key] = finalResult;
    DB.set("lm_tx_cache", state.txCache);
    return finalResult;

  }catch(e){
    console.log(e);
    return ""; 
  }
}

/* ===========================
   2. HIZLI Ã‡EVÄ°RÄ° BUTONU MANTIÄI
=========================== */
let quickTermCache = ""; // Karta eklerken kullanmak iÃ§in

async function doQuickTranslate(){
  const input = document.getElementById("quickTransInput");
  if(!input) return; // Kutu yoksa dur
  
  const term = input.value.trim();
  if(!term) return toast("LÃ¼tfen bir kelime yazÄ±n.");

  toast("Ã‡evriliyor... â³");
  
  // 1. Google'dan detaylÄ± anlamÄ± Ã§ek (VarsayÄ±lan EN gÃ¶nderiyoruz, Google dili anlar)
  const meaning = await translateToTR("EN", term);
  
  // 2. Ä°ngilizce SÃ¶zlÃ¼k verisi (Sadece harflerden oluÅŸuyorsa bak)
  let dictInfo = "";
  if(term.match(/^[a-zA-Z\s]+$/)){
     const dict = await lookupEN(term);
     if(dict){
       dictInfo = `
       <div style="margin-top:15px; padding:12px; background:var(--card2); border-radius:12px; border:1px solid var(--border);">
         <div style="font-weight:bold; color:var(--muted); margin-bottom:4px;">ğŸ‡¬ğŸ‡§ Ä°ngilizce SÃ¶zlÃ¼k:</div>
         <div style="font-style:italic;">${dict.type}</div>
         <div style="margin-top:4px;">${dict.definitionEN}</div>
         <div style="color:var(--primary); margin-top:6px; font-weight:500;">"${dict.exampleEN}"</div>
       </div>`;
     }
  }

  // 3. SonuÃ§ ekranÄ±nÄ± hazÄ±rla
  const content = `
    <div style="font-size:28px; font-weight:900; color:var(--primary); text-align:center; margin-bottom:10px;">${term}</div>
    <div style="font-size:16px; line-height:1.5; white-space:pre-wrap; background:var(--card); padding:12px; border-radius:12px; border:1px solid var(--border);">${meaning}</div>
    ${dictInfo}
  `;

  // 4. Pencereyi aÃ§
  document.getElementById("trResContent").innerHTML = content;
  quickTermCache = term; 
  openSheet("transResultSheet"); 
  input.value = ""; // Kutuyu temizle
}

// "Bu Kelimeyi Karta Ekle" butonuna basÄ±nca Ã§alÄ±ÅŸÄ±r
function copyToManualAdd(){
  closeSheets(); // SonuÃ§ penceresini kapat
  openManualAdd(); // Ekleme penceresini aÃ§
  
  // Kelimeyi kutuya yaz
  document.getElementById("maTerm").value = quickTermCache;
  
  // Otomatik doldurmayÄ± tetikle
  autoFillManualFields(true);
}

/* ===========================
   ONLINE: Dictionary (EN only)
   - dictionaryapi.dev returns meanings/partOfSpeech/examples
=========================== */
function mapPosToType(pos){
  const p=(pos||"").toLowerCase();
  if(p==="noun") return "noun";
  if(p==="verb") return "verb";
  if(p==="adjective") return "adj";
  if(p==="adverb") return "adv";
  if(p==="phrasal verb") return "phrasal";
  if(p==="idiom") return "idiom";
  return "word";
}

async function lookupEN(term){
  const k = norm(term);
  if(!k) return null;
  if(state.dictCache[k]) return state.dictCache[k];

  const url = `https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(k)}`;
  try{
    const r = await fetch(url);
    if(!r.ok) throw new Error("dict_fail");
    const data = await r.json();

    // pick first meaning/definition/example
    let pos="", def="", ex="";
    const meanings = data?.[0]?.meanings || [];
    for(const m of meanings){
      if(!pos && m.partOfSpeech) pos = m.partOfSpeech;
      const defs = m.definitions || [];
      for(const d of defs){
        if(!def && d.definition) def = d.definition;
        if(!ex && d.example) ex = d.example;
        if(def && ex) break;
      }
      if(def && ex) break;
    }

    const result = {
      pos: pos || "",
      type: mapPosToType(pos),
      definitionEN: def || "",
      exampleEN: ex || ""
    };
    state.dictCache[k] = result;
    DB.set("lm_dict_cache", state.dictCache);
    return result;
  }catch(e){
    return null;
  }
}

/* ===========================
   Example generator (fallback)
=========================== */
function genExample(term, lang, type){
  const t = term.trim();
  if(!t) return "";
  if(lang==="EN"){
    if(type==="verb") return `Workers ${t} the elements according to the drawing.`;
    if(type==="noun") return `The ${t} was checked during inspection.`;
    if(type==="adj") return `The structure remained ${t} under the design load.`;
    if(type==="adv") return `The crew worked ${t} to finish before sunset.`;
    if(type==="phrase") return `We reviewed "${t}" before starting the work.`;
    return `We used "${t}" in the daily site report.`;
  }
  return `(${lang}) ${t} â€” Ã¶rnek cÃ¼mle (istersen dÃ¼zenle).`;
}

function inferTypeBasic(term){
  if(term.includes(" ")) return "phrase";
  return "word";
}

/* ===========================
   SRS (SM-2 style)
=========================== */
function srsCalc(card, quality){
  let s = card.srs || { interval:0, reps:0, ef:2.5 };
  let { interval, reps, ef } = s;

  if(quality >= 3){
    if(reps === 0) interval = 1;
    else if(reps === 1) interval = 6;
    else interval = Math.round(interval * ef);
    reps++;
    ef = ef + (0.1 - (5 - quality) * (0.08 + (5 - quality) * 0.02));
    if(ef < 1.3) ef = 1.3;
  }else{
    reps = 0;
    interval = 1;
  }
  return { due: now() + interval*24*60*60*1000, srs:{interval,reps,ef} };
}

/* ===========================
   Dash + Review
=========================== */
function renderDash(){
  document.getElementById("dashTotal").textContent = state.cards.length;
  document.getElementById("dashDue").textContent = state.cards.filter(c => (c.due||0) <= now()).length;
}
function getDueCards(){ return state.cards.filter(c => (c.due||0) <= now()); }
function renderReview(){
  document.getElementById("rvTotal").textContent = state.cards.length;
  document.getElementById("rvDue").textContent = getDueCards().length;
  syncQuizModeLabels();
}
function resetTodaysQueue(){
  // 1. Vakti gelen (Due) kartlarÄ± bul
  let due = getDueCards();
  let q = [];

  if(due.length > 0) {
    // Vakti gelenleri RASTGELE karÄ±ÅŸtÄ±r (Shuffle)
    q = due.sort(() => Math.random() - 0.5).map(c => c.id);
  } else {
    // Vakti gelen yoksa, tÃ¼m havuzdan RASTGELE 30 tane seÃ§
    q = [...state.cards]
        .sort(() => Math.random() - 0.5)
        .slice(0, Math.min(30, state.cards.length))
        .map(c => c.id);
  }

  state.reviewQueue = q;
  DB.set("lm_review_queue", state.reviewQueue);
  
  // KullanÄ±cÄ±ya bilgi ver
  toast("Kuyruk karÄ±ÅŸtÄ±rÄ±ldÄ± ğŸ”€");
  renderReview();
}
function clearProgress(){
  if(!confirm("SRS sÄ±fÄ±rlansÄ±n mÄ±? (Kartlar silinmez)")) return;
  state.cards = state.cards.map(c=>({...c,due:now(),srs:{interval:0,reps:0,ef:2.5},updatedAt:now()}));
  DB.set("lm_cards", state.cards);
  toast("SRS sÄ±fÄ±rlandÄ± âœ…");
  renderDash(); renderReview(); renderCards();
}

/* ===========================
   Cards list
=========================== */
document.getElementById("search").addEventListener("input", renderCards);
function renderCards(){
  const q = norm(document.getElementById("search").value);
  const list = document.getElementById("cardsList");
  list.innerHTML="";

  const items = state.cards
    .filter(c=>{
      if(!q) return true;
      return norm(c.term).includes(q) || norm(c.meaning).includes(q) || norm(c.type).includes(q);
    })
    .sort((a,b)=> (a.term||"").localeCompare((b.term||""), "en"));

  if(!items.length){
    const e=document.createElement("div");
    e.className="card";
    e.innerHTML=`<div style="font-weight:980;">HenÃ¼z kart yok</div><div class="smallInfo">â• Elle Kelime Ekle ile baÅŸla.</div>`;
    list.appendChild(e);
    return;
  }

  items.forEach(c=>{
    const isDue=(c.due||0) <= now();
    const el=document.createElement("div");
    el.className="card";
    el.style.marginTop="12px";
    el.innerHTML=`
      <div class="cardLine">
        <div class="termBig">${safeText(c.term)}</div>
        <div class="badge ${isDue?'due':''}">${isDue?'Tekrar':'Tamam'}</div>
      </div>
      <div class="smallInfo">${safeText(c.lang)} â€¢ ${safeText(c.meaning)}</div>
      <div class="smallInfo" style="margin-top:6px;">TÃ¼r: ${safeText(c.type||'-')}</div>
      <div class="smallInfo" style="margin-top:6px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">
        ${safeText(c.example||'')}
      </div>
      <div class="two" style="margin-top:10px;">
        <button class="btn btnSoft btnHalf" data-edit="${c.id}">DÃ¼zenle</button>
        <button class="btn btnDanger btnHalf" data-del="${c.id}">Sil</button>
      </div>
    `;
    el.querySelector(`[data-edit="${c.id}"]`).onclick=()=>openEditPrompt(c.id);
    el.querySelector(`[data-del="${c.id}"]`).onclick=()=>deleteCard(c.id);
    list.appendChild(el);
  });
}

/* ===========================
   Manual Add (ONLINE AUTOFILL)
=========================== */
let autoTimer=null;
function openManualAdd(){
  clearManual();
  openSheet("manualAddSheet");
}
function clearManual(){
  document.getElementById("maLang").value="EN";
  document.getElementById("maTerm").value="";
  document.getElementById("maMeaning").value="";
  document.getElementById("maType").value="word";
  document.getElementById("maExample").value="";
  document.getElementById("maNote").value="";
  document.getElementById("maHint").textContent="YazÄ±nca otomatik doldurur. Ä°nternet ÅŸart.";
}
document.getElementById("maTerm").addEventListener("input", ()=>{
  clearTimeout(autoTimer);
  autoTimer=setTimeout(()=>autoFillManualFields(false), 450);
});
document.getElementById("maLang").addEventListener("change", ()=>{
  clearTimeout(autoTimer);
  autoTimer=setTimeout(()=>autoFillManualFields(false), 250);
});
document.getElementById("maTerm").addEventListener("keydown",(e)=>{
  if(e.key==="Enter"){
    e.preventDefault();
    autoFillManualFields(true);
  }
});

async function autoFillManualFields(force){
  const lang=document.getElementById("maLang").value;
  const term=document.getElementById("maTerm").value.trim();
  if(!term) return;

  document.getElementById("maHint").textContent="Dolduruluyorâ€¦";

  // TYPE + EXAMPLE (try dictionary for EN)
  let type = document.getElementById("maType").value;
  let example = document.getElementById("maExample").value.trim();
  let meaning = document.getElementById("maMeaning").value.trim();

  // EN dictionary
  if(lang==="EN"){
    const dict = await lookupEN(term);
    if(dict){
      if((!type || type==="word" || force) && dict.type) type = dict.type;
      // Prefer dictionary example
      if((!example || force) && dict.exampleEN) example = dict.exampleEN;
      // If no example in dict, generate
      if((!example || force) && !dict.exampleEN) example = genExample(term, lang, type);
    }else{
      if((!type || type==="word") && (force || !type)) type = inferTypeBasic(term);
      if((!example || force) && !example) example = genExample(term, lang, type);
    }
  }else{
    // non-EN: basic type + template example
    if((!type || type==="word" || force)) type = inferTypeBasic(term);
    if((!example || force)) example = genExample(term, lang, type);
  }

  // MEANING: always translate to TR
  if((!meaning || force)){
    const tr = await translateToTR(lang, term);
    if(tr) meaning = tr;
  }

  document.getElementById("maType").value = type || "word";
  document.getElementById("maExample").value = example || "";
  document.getElementById("maMeaning").value = meaning || "";

  if(!meaning){
    document.getElementById("maHint").textContent="Anlam alÄ±namadÄ± (internet/translate engeli olabilir).";
  }else{
    document.getElementById("maHint").textContent="Otomatik dolduruldu âœ… (istersen dÃ¼zenle)";
  }
}

function saveManualCard(){
  const lang=document.getElementById("maLang").value;
  const term=document.getElementById("maTerm").value.trim();
  const meaning=document.getElementById("maMeaning").value.trim();
  const type=document.getElementById("maType").value;
  const example=document.getElementById("maExample").value.trim();
  const note=document.getElementById("maNote").value.trim();

  if(!term) return toast("Kelime boÅŸ olamaz.");
  if(!meaning) return toast("Anlam boÅŸ olamaz (doldur/manuel gir).");

  const dupe = state.cards.find(c => norm(c.term)===norm(term) && (c.lang||"EN")===lang);
  if(dupe){
    if(confirm("Bu kelime zaten var. GÃ¼ncellensin mi?")){
      dupe.meaning=meaning;
      dupe.type=type;
      dupe.example=example;
      dupe.note=note;
      dupe.updatedAt=now();
      DB.set("lm_cards", state.cards);
      toast("GÃ¼ncellendi âœ…");
      closeSheets(); renderDash(); renderReview(); renderCards();
    }
    return;
  }

  state.cards.push({
    id:uid(),
    lang, term, meaning, type, example, note,
    due: now(),
    srs:{interval:0,reps:0,ef:2.5},
    createdAt: now(),
    updatedAt: now()
  });
  DB.set("lm_cards", state.cards);
  toast("Eklendi âœ…");
  closeSheets(); renderDash(); renderReview(); renderCards();
}

function deleteCard(id){
  if(!confirm("Silinsin mi?")) return;
  state.cards = state.cards.filter(c=>c.id!==id);
  DB.set("lm_cards", state.cards);
  state.reviewQueue = (state.reviewQueue||[]).filter(x=>x!==id);
  DB.set("lm_review_queue", state.reviewQueue);
  toast("Silindi");
  renderDash(); renderReview(); renderCards();
}

/* Simple edit prompt (keep UI minimal) */
function openEditPrompt(id){
  const c = state.cards.find(x=>x.id===id);
  if(!c) return;
  const newMeaning = prompt("Anlam (TR):", c.meaning || "");
  if(newMeaning===null) return;
  const newType = prompt("TÃ¼r (noun/verb/adj/adv/phrase/wordâ€¦):", c.type || "word");
  if(newType===null) return;
  const newExample = prompt("Ã–rnek cÃ¼mle:", c.example || "");
  if(newExample===null) return;

  c.meaning = newMeaning.trim();
  c.type = (newType||"word").trim();
  c.example = (newExample||"").trim();
  c.updatedAt = now();
  DB.set("lm_cards", state.cards);
  toast("GÃ¼ncellendi âœ…");
  renderCards();
}

/* ===========================
   Quiz
=========================== */
function getQuizMode(){ return state.settings.quizMode || "choice"; }
function syncQuizModeLabels(){
  const label=(getQuizMode()==="typing")?"YazmalÄ±":"SeÃ§meli";
  document.getElementById("quizModeLabel").textContent=label;
  document.getElementById("quizModeLabel2").textContent=label;
}
function toggleQuizMode(){
  state.settings.quizMode = (getQuizMode()==="choice") ? "typing" : "choice";
  DB.set("lm_settings", state.settings);
  syncQuizModeLabels();
  toast("Quiz modu: " + ((getQuizMode()==="typing")?"YazmalÄ±":"SeÃ§meli"));
}
let quizCurrent=null;
let correctCount=0, wrongCount=0;
// GÃœNCELLENMÄ°Å START FONKSÄ°YONU (LÄ°MÄ°TLÄ°)
function startReviewQuiz(limit = 9999){
  closeSheets();
  
  // 1. "Tekrar" (Due) zamanÄ± gelenleri bul
  const now = Date.now();
  let dueCards = state.cards.filter(c => (c.due || 0) <= now);

  // 2. EÄŸer hiÃ§ tekrar yoksa, rastgele pratik yap
  if(dueCards.length === 0){
    dueCards = [...state.cards].sort(() => Math.random() - 0.5);
  } else {
    // Varsa tarihe gÃ¶re sÄ±rala (En eskiler Ã¶nce)
    dueCards.sort((a,b) => (a.due||0) - (b.due||0));
  }

  // 3. LÄ°MÄ°T UYGULA (SeÃ§ilen sayÄ± kadar al)
  if(dueCards.length > limit){
     dueCards = dueCards.slice(0, limit);
  }

  // 4. KuyruÄŸa ata ve baÅŸlat
  state.reviewQueue = dueCards.map(c => c.id);
  DB.set("lm_review_queue", state.reviewQueue);

  if(state.reviewQueue.length === 0) return toast("Ã‡alÄ±ÅŸÄ±lacak kart yok!");

  // Quiz ekranÄ±nÄ± aÃ§
  document.getElementById("quizOverlay").classList.add("active");
  nextQuiz();
}
function openQuizOverlay(){
  document.getElementById("quizOverlay").classList.add("open");
  document.getElementById("qInput").onkeydown=(e)=>{
    if(e.key==="Enter"){ e.preventDefault(); checkTypingAnswer(); }
  };
}
function stopQuiz(){
  // --- DÃœZELTME BAÅLANGICI ---
  // EÄŸer ekranda aktif bir soru varken Ã§Ä±kÄ±ÅŸ yapÄ±lÄ±yorsa,
  // o soruyu kuyruÄŸun EN BAÅINA geri ekle (bÃ¶ylece sayÄ± dÃ¼ÅŸmez)
  if(quizCurrent && quizCurrent.id){
     state.reviewQueue.unshift(quizCurrent.id);
     DB.set("lm_review_queue", state.reviewQueue);
  }
  // --- DÃœZELTME BÄ°TÄ°ÅÄ° ---

  document.getElementById("quizOverlay").classList.remove("open");
  quizCurrent=null;
  renderDash(); renderReview();
}
function updateQuizRemain(){
  document.getElementById("qRemain").textContent=String(state.reviewQueue.length);
}
/* ===========================
   BAÄLAM (CONTEXT) MODU QUÄ°Z SÄ°STEMÄ°
   - Soruyu cÃ¼mle iÃ§inde boÅŸluk olarak sorar.
   - Cevap olarak kelimenin kendisini ister.
=========================== */
/* ===========================
   GÃœNCELLENMÄ°Å QUIZ GÃ–RÃœNÃœMÃœ
   (Soru iÅŸareti kalktÄ±, ÅŸÄ±k boÅŸluk geldi)
=========================== */
/* ===========================
   GÃœNCELLENMÄ°Å QUIZ (Sadece EN -> TR ve Context)
   - Asla TÃ¼rkÃ§e kelime verip Ä°ngilizcesini sormaz.
   - Ya cÃ¼mle tamamlatÄ±r (En->En) ya da Kelime sorar (En->Tr).
=========================== */
/* ===========================
   ADIM 2: GELÄ°ÅMÄ°Å QUIZ (Ä°PUÃ‡LU & AÃ‡IKLAMALI)
=========================== */
function nextQuiz(){
  if(!state.reviewQueue.length){
    toast("Tebrikler! Hepsi bitti ğŸ‰");
    stopQuiz();
    return;
  }
  updateQuizRemain();
  
  const id = state.reviewQueue.shift();
  DB.set("lm_review_queue", state.reviewQueue);
  
  const card = state.cards.find(c => c.id === id);
  if(!card) return nextQuiz();

  quizCurrent = card;

  // --- SORU HAZIRLIÄI ---
  let isContextMode = false;
  let questionHtml = "";
  let hintText = "";
  let explanationHtml = ""; 
  
  // 1. CONTEXT MODU (CÃ¼mle varsa)
  if(card.example && card.example.length > 5) {
     const termRegex = new RegExp(`\\b${card.term}\\b`, "gi"); 
     // ÅÄ±k boÅŸluk Ã§izgisi
     const blankStyle = `<span style='color:var(--primary); border-bottom:3px solid var(--primary); font-weight:bold;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>`;
     
     const hiddenExample = card.example.replace(termRegex, blankStyle);
     
     if(hiddenExample !== card.example){
        isContextMode = true; 
        questionHtml = hiddenExample; 
        hintText = "BoÅŸluÄŸa hangisi gelmeli?";
        // Ä°PUCU: CÃ¼mlenin TÃ¼rkÃ§e anlamÄ± (Varsa)
        explanationHtml = `<div style="margin-top:20px; font-size:16px; color:var(--muted); font-style:italic;">ğŸ‡¹ğŸ‡· Ä°pucu: "${card.meaning}"</div>`;
     }
  }

  // 2. KLASÄ°K MOD (Kelime -> Anlam)
  if(!isContextMode) {
     questionHtml = `<span style="font-size:36px; color:var(--primary);">${card.term}</span>`;
     hintText = "Bu kelimenin anlamÄ± nedir?";
     
     // Ä°PUCU: Ä°ngilizce Ã¶rnek cÃ¼mle (Kelimeyi gizleyerek)
     if(card.example && card.example.length > 5){
        const termRegex = new RegExp(`\\b${card.term}\\b`, "gi");
        const hiddenInExample = card.example.replace(termRegex, "___");
        explanationHtml = `<div style="margin-top:20px; font-size:16px; color:var(--text); opacity:0.8;">ğŸ‡¬ğŸ‡§ Ã–rnek: "${hiddenInExample}"</div>`;
     } else {
        explanationHtml = `<div style="margin-top:20px; font-size:14px; color:var(--muted);">(Ã–rnek cÃ¼mle yok)</div>`;
     }
  }

  // EKRANA YAZDIR (Soru + AÃ§Ä±klama)
  const qWordEl = document.getElementById("qWord");
  qWordEl.innerHTML = `
    <div>${questionHtml}</div>
    ${explanationHtml}
  `;
  
  // Font AyarÄ±
  if(qWordEl.innerText.length > 80) qWordEl.style.fontSize = "20px";
  else if(!isContextMode) qWordEl.style.fontSize = "28px";
  else qWordEl.style.fontSize = "24px";

  document.getElementById("qMeta").textContent = hintText;
  document.getElementById("qExample").textContent = ""; 
  document.getElementById("qReveal").textContent="";

  // ÅIKLARI HAZIRLA
  const choicesBox = document.getElementById("qChoices");
  const typingBox = document.getElementById("qTyping");
  choicesBox.innerHTML = "";
  typingBox.style.display = "none";
  choicesBox.style.display = "flex";

  let options = [];
  let correctVal = "";

  if(isContextMode){
      correctVal = card.term;
      const distractors = state.cards.filter(c => c.id !== card.id).sort(() => Math.random() - 0.5).slice(0, 3).map(x => x.term);
      options = [...distractors, correctVal].sort(() => Math.random() - 0.5);
  } else {
      correctVal = card.meaning;
      const distractors = state.cards.filter(c => c.id !== card.id).sort(() => Math.random() - 0.5).slice(0, 3).map(x => x.meaning);
      options = [...distractors, correctVal].sort(() => Math.random() - 0.5);
  }

  options.forEach(opt => {
      const b = document.createElement("button");
      b.className = "qChoice";
      b.textContent = opt; 
      b.onclick = () => {
        document.querySelectorAll(".qChoice").forEach(x => x.disabled = true);
        if(opt === correctVal){
          b.classList.add("correct");
          // DoÄŸruysa cÃ¼mleyi tamamla
          if(isContextMode){
             const completedHtml = card.example.replace(new RegExp(`\\b${card.term}\\b`, "gi"), `<span style='color:var(--ok); font-weight:900;'>${card.term}</span>`);
             qWordEl.innerHTML = `<div>${completedHtml}</div>${explanationHtml}`;
          }
          document.getElementById("qMeta").innerHTML = `<span style='color:var(--ok)'>âœ… DoÄŸru!</span>`;
          grade(card, 5, true);
        } else {
          b.classList.add("wrong");
          document.querySelectorAll(".qChoice").forEach(btn => { if(btn.textContent === correctVal) btn.classList.add("correct"); });
          if(isContextMode) document.getElementById("qExample").textContent = `DoÄŸrusu: ${card.example}`;
          grade(card, 2, false);
        }
      };
      choicesBox.appendChild(b);
  });
}
function normalizeAnswer(a){
  return norm(a).replace(/[.,!?;:"(){}\[\]<>]/g,"").replace(/\s+/g," ").trim();
}
function checkTypingAnswer(){
  if(!quizCurrent) return;
  const typed = normalizeAnswer(document.getElementById("qInput").value);
  if(!typed) return toast("Bir cevap yazÄ±n.");
  
  // ArtÄ±k kontrol ettiÄŸimiz ÅŸey KELÄ°MENÄ°N KENDÄ°SÄ° (term)
  const correct = normalizeAnswer(quizCurrent.term);
  
  const ok = (typed === correct);
  
  if(ok){
    document.getElementById("qReveal").textContent = "âœ… DoÄŸru!";
    document.getElementById("qExample").textContent = quizCurrent.example; 
    grade(quizCurrent, 5, true);
  } else {
    document.getElementById("qReveal").textContent = `âŒ DoÄŸrusu: ${quizCurrent.term}`;
    document.getElementById("qExample").textContent = quizCurrent.example;
    grade(quizCurrent, 2, false);
  }
}
function grade(card, quality, isCorrect){
  if(isCorrect){ correctCount++; document.getElementById("qCorrect").textContent=String(correctCount); }
  else{ wrongCount++; document.getElementById("qWrong").textContent=String(wrongCount); }

  const upd = srsCalc(card, quality);
  card.due = upd.due;
  card.srs = upd.srs;
  card.updatedAt = now();
  DB.set("lm_cards", state.cards);

  setTimeout(()=>{ quizCurrent=null; nextQuiz(); }, 550);
}
function skipQuestion(){
  if(!quizCurrent) return;
  state.reviewQueue.push(quizCurrent.id);
  DB.set("lm_review_queue", state.reviewQueue);
  toast("Soru sona atÄ±ldÄ±");
  quizCurrent=null;
  nextQuiz();
}

/* Speak */
function speakText(txt, lang){
  const u=new SpeechSynthesisUtterance(txt);
  // Ä°spanyolca (ES: 'es-ES') eklendi
const map={EN:"en-US", RU:"ru-RU", DE:"de-DE", FR:"fr-FR", ES:"es-ES", TR:"tr-TR"};
  u.lang=map[lang] || "en-US";
  u.rate=0.9;
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}
function speakQuizWord(){
  if(!quizCurrent) return;
  speakText(quizCurrent.term, quizCurrent.lang || "EN");
}

/* ===========================
   Export/Import/Reset
=========================== */
function exportAll(){
  const data = JSON.stringify({ settings:state.settings, cards:state.cards }, null, 2);
  prompt("Kopyala (Export JSON):", data);
}
function importAllPrompt(){
  const txt = prompt("Import JSON yapÄ±ÅŸtÄ±r:");
  if(!txt) return;
  try{
    const obj=JSON.parse(txt);
    if(obj.settings) state.settings=obj.settings;
    if(obj.cards) state.cards=obj.cards;
    saveAll();
    setTheme(state.settings.theme || "dark");
    syncQuizModeLabels();
    toast("Import âœ…");
    renderDash(); renderReview(); renderCards();
  }catch(e){
    toast("Import hata");
  }
}
function hardReset(){
  if(!confirm("Her ÅŸeyi sÄ±fÄ±rlamak istiyor musun?")) return;
  localStorage.clear();
  location.reload();
}
/* ===========================
   TOP 100 Ä°NGÄ°LÄ°ZCE KELÄ°ME PAKETÄ° (VeritabanÄ± boÅŸsa yÃ¼klenir)
=========================== */
if (state.cards.length === 0) {
  // En sÄ±k kullanÄ±lan, akademik ve gÃ¼nlÃ¼k hayati kelimelerden seÃ§ki
  const starterPack = [
    // --- VERBS (Fiiller) ---
    { t: "achieve", m: "baÅŸarmak, elde etmek", y: "verb", e: "She worked hard to achieve her goals." },
    { t: "admit", m: "kabul etmek, itiraf etmek", y: "verb", e: "He admitted that he made a mistake." },
    { t: "affect", m: "etkilemek", y: "verb", e: "The weather can affect your mood." },
    { t: "afford", m: "gÃ¼cÃ¼ yetmek (maddi)", y: "verb", e: "I can't afford a new car right now." },
    { t: "allow", m: "izin vermenk", y: "verb", e: "Smoking is not allowed here." },
    { t: "appear", m: "gÃ¶rÃ¼nmek, ortaya Ã§Ä±kmak", y: "verb", e: "He appears to be tired." },
    { t: "appreciate", m: "takdir etmek, deÄŸerini bilmek", y: "verb", e: "I appreciate your help." },
    { t: "argue", m: "tartÄ±ÅŸmak, iddia etmek", y: "verb", e: "They argue about money all the time." },
    { t: "avoid", m: "kaÃ§Ä±nmak", y: "verb", e: "You should avoid eating too much sugar." },
    { t: "become", m: "olmak, haline gelmek", y: "verb", e: "The caterpillar becomes a butterfly." },
    { t: "believe", m: "inanmak", y: "verb", e: "I believe in you." },
    { t: "borrow", m: "Ã¶dÃ¼nÃ§ almak", y: "verb", e: "Can I borrow your pen?" },
    { t: "complain", m: "ÅŸikayet etmek", y: "verb", e: "He is always complaining about the noise." },
    { t: "consider", m: "gÃ¶z Ã¶nÃ¼nde bulundurmak, dÃ¼ÅŸÃ¼nmek", y: "verb", e: "Please consider my offer." },
    { t: "contain", m: "iÃ§ermek", y: "verb", e: "This box contains old photos." },
    { t: "convince", m: "ikna etmek", y: "verb", e: "I couldn't convince him to stay." },
    { t: "create", m: "yaratmak, oluÅŸturmak", y: "verb", e: "The software creates a backup automatically." },
    { t: "decide", m: "karar vermek", y: "verb", e: "Have you decided what to wear?" },
    { t: "describe", m: "tarif etmek, tanÄ±mlamak", y: "verb", e: "Can you describe the thief?" },
    { t: "develop", m: "geliÅŸtirmek", y: "verb", e: "They are developing a new drug." },
    { t: "disappear", m: "gÃ¶zden kaybolmak", y: "verb", e: "The sun disappeared behind the clouds." },
    { t: "discover", m: "keÅŸfetmek", y: "verb", e: "Columbus discovered America." },
    { t: "encourage", m: "cesaretlendirmek, teÅŸvik etmek", y: "verb", e: "My teacher encouraged me to study art." },
    { t: "establish", m: "kurmak, tesis etmek", y: "verb", e: "The company was established in 1990." },
    { t: "exist", m: "var olmak", y: "verb", e: "Does life exist on other planets?" },
    { t: "expect", m: "ummak, beklemek", y: "verb", e: "I expect him to be late." },
    { t: "explain", m: "aÃ§Ä±klamak", y: "verb", e: "Can you explain this rule to me?" },
    { t: "explore", m: "keÅŸfe Ã§Ä±kmak, incelemek", y: "verb", e: "We explored the old city." },
    { t: "improve", m: "geliÅŸtirmek, iyileÅŸtirmek", y: "verb", e: "You need to improve your English." },
    { t: "increase", m: "artmak, arttÄ±rmak", y: "verb", e: "Sales increased by 10% this year." },
    { t: "indicate", m: "gÃ¶stermek, iÅŸaret etmek", y: "verb", e: "The map indicates where the treasure is." },
    { t: "insist", m: "Ä±srar etmek", y: "verb", e: "She insisted on paying for dinner." },
    { t: "involve", m: "iÃ§ermek, kapsamak", y: "verb", e: "The job involves a lot of travel." },
    { t: "mention", m: "bahsetmek", y: "verb", e: "Did he mention my name?" },
    { t: "obtain", m: "elde etmek, edinmek", y: "verb", e: "Where can I obtain a visa?" },
    { t: "occur", m: "meydana gelmek", y: "verb", e: "The accident occurred at night." },
    { t: "offer", m: "teklif etmek, sunmak", y: "verb", e: "He offered me a job." },
    { t: "participate", m: "katÄ±lmak", y: "verb", e: "All students must participate in the event." },
    { t: "perform", m: "sahnelemek, performans gÃ¶stermek", y: "verb", e: "The band performed live." },
    { t: "persuade", m: "ikna etmek", y: "verb", e: "Try to persuade him to come." },
    { t: "predict", m: "tahmin etmek, Ã¶ngÃ¶rmek", y: "verb", e: "It is hard to predict the weather." },
    { t: "prepare", m: "hazÄ±rlamak", y: "verb", e: "I need to prepare for the exam." },
    { t: "prevent", m: "Ã¶nlemek, engel olmak", y: "verb", e: "Seatbelts prevent injuries." },
    { t: "produce", m: "Ã¼retmek", y: "verb", e: "This factory produces cars." },
    { t: "protect", m: "korumak", y: "verb", e: "Sunglasses protect your eyes from the sun." },
    { t: "prove", m: "kanÄ±tlamak", y: "verb", e: "Can you prove your theory?" },
    { t: "provide", m: "saÄŸlamak, temin etmek", y: "verb", e: "The hotel provides free Wi-Fi." },
    { t: "realize", m: "farkÄ±na varmak", y: "verb", e: "I realized I left my keys at home." },
    { t: "recognize", m: "tanÄ±mak (birini/bir ÅŸeyi)", y: "verb", e: "I didn't recognize him with a beard." },
    { t: "reduce", m: "azaltmak", y: "verb", e: "We need to reduce costs." },
    { t: "refuse", m: "reddetmek", y: "verb", e: "He refused to answer the question." },
    { t: "regret", m: "piÅŸman olmak", y: "verb", e: "I regret saying that." },
    { t: "relate", m: "iliÅŸkilendirmek", y: "verb", e: "How does this relate to the problem?" },
    { t: "remain", m: "kalmak (durumunu korumak)", y: "verb", e: "Please remain seated." },
    { t: "remember", m: "hatÄ±rlamak", y: "verb", e: "Do you remember me?" },
    { t: "remind", m: "hatÄ±rlatmak", y: "verb", e: "Please remind me to call her." },
    { t: "replace", m: "yerini almak, deÄŸiÅŸtirmek", y: "verb", e: "Robots might replace workers." },
    { t: "require", m: "gerektirmek", y: "verb", e: "Plants require water to grow." },
    { t: "reveal", m: "aÃ§Ä±ÄŸa Ã§Ä±karmak", y: "verb", e: "The investigation revealed the truth." },
    { t: "seem", m: "gibi gÃ¶rÃ¼nmek", y: "verb", e: "It seems like a good idea." },
    { t: "solve", m: "Ã§Ã¶zmek", y: "verb", e: "I can't solve this puzzle." },
    { t: "suffer", m: "acÄ± Ã§ekmek, katlanmak", y: "verb", e: "She suffers from migraines." },
    { t: "suggest", m: "Ã¶nermek", y: "verb", e: "I suggest you take a taxi." },
    { t: "supply", m: "tedarik etmek", y: "verb", e: "They supply us with paper." },
    { t: "suppose", m: "varsaymak, zannetmek", y: "verb", e: "I suppose you are right." },
    { t: "survive", m: "hayatta kalmak", y: "verb", e: "Only a few survived the crash." },
    { t: "tend", m: "eÄŸiliminde olmak", y: "verb", e: "Prices tend to go up in winter." },
    { t: "threaten", m: "tehdit etmek", y: "verb", e: "He threatened to call the police." },
    { t: "understand", m: "anlamak", y: "verb", e: "I don't understand French." },
    { t: "wonder", m: "merak etmek", y: "verb", e: "I wonder what happened." },

    // --- NOUNS (Ä°simler) ---
    { t: "ability", m: "yetenek", y: "noun", e: "He has the ability to learn quickly." },
    { t: "access", m: "eriÅŸim", y: "noun", e: "Do you have internet access?" },
    { t: "accident", m: "kaza", y: "noun", e: "He had a car accident." },
    { t: "account", m: "hesap", y: "noun", e: "I opened a bank account." },
    { t: "advantage", m: "avantaj", y: "noun", e: "Speed is a big advantage." },
    { t: "advice", m: "tavsiye", y: "noun", e: "Can you give me some advice?" },
    { t: "amount", m: "miktar", y: "noun", e: "A large amount of money." },
    { t: "attitude", m: "tavÄ±r, tutum", y: "noun", e: "She has a positive attitude." },
    { t: "audience", m: "seyirci kitlesi", y: "noun", e: "The audience clapped loudly." },
    { t: "behavior", m: "davranÄ±ÅŸ", y: "noun", e: "His behavior was unacceptable." },
    { t: "benefit", m: "fayda, yarar", y: "noun", e: "The benefits of exercise are many." },
    { t: "career", m: "kariyer", y: "noun", e: "She wants a career in medicine." },
    { t: "challenge", m: "zorluk, meydan okuma", y: "noun", e: "This game is a real challenge." },
    { t: "choice", m: "seÃ§im", y: "noun", e: "It was a difficult choice." },
    { t: "circumstance", m: "koÅŸul, durum", y: "noun", e: "Under normal circumstances, I would agree." },
    { t: "community", m: "topluluk", y: "noun", e: "We have a strong community." },
    { t: "competition", m: "yarÄ±ÅŸma, rekabet", y: "noun", e: "There is a lot of competition." },
    { t: "complaint", m: "ÅŸikayet", y: "noun", e: "I have a complaint about the food." },
    { t: "conclusion", m: "sonuÃ§", y: "noun", e: "What is your conclusion?" },
    { t: "condition", m: "durum, ÅŸart", y: "noun", e: "The car is in good condition." },
    { t: "consequence", m: "sonuÃ§ (genelde kÃ¶tÃ¼)", y: "noun", e: "You must face the consequences." },
    { t: "contribution", m: "katkÄ±", y: "noun", e: "Thank you for your contribution." },
    { t: "courage", m: "cesaret", y: "noun", e: "It takes courage to speak up." },
    { t: "culture", m: "kÃ¼ltÃ¼r", y: "noun", e: "I love learning about other cultures." },
    { t: "damage", m: "hasar", y: "noun", e: "The storm caused a lot of damage." },
    { t: "decision", m: "karar", y: "noun", e: "It was a tough decision." },
    { t: "demand", m: "talep", y: "noun", e: "Supply and demand." },
    { t: "development", m: "geliÅŸim", y: "noun", e: "Economic development is slow." },
    { t: "difference", m: "fark", y: "noun", e: "What is the difference?" },
    { t: "direction", m: "yÃ¶n", y: "noun", e: "Which direction did he go?" },
    { t: "disease", m: "hastalÄ±k", y: "noun", e: "Heart disease is common." },
    { t: "doubt", m: "ÅŸÃ¼phe", y: "noun", e: "I have no doubt about it." },
    { t: "economy", m: "ekonomi", y: "noun", e: "The global economy is recovering." },
    { t: "education", m: "eÄŸitim", y: "noun", e: "Education is very important." },
    { t: "effect", m: "etki", y: "noun", e: "The special effects were amazing." },
    { t: "effort", m: "Ã§aba", y: "noun", e: "He put a lot of effort into this." },
    { t: "election", m: "seÃ§im (siyasi)", y: "noun", e: "The election is next month." },
    { t: "emotion", m: "duygu", y: "noun", e: "Fear is a strong emotion." },
    { t: "emphasis", m: "vurgu", y: "noun", e: "The emphasis is on quality." },
    { t: "energy", m: "enerji", y: "noun", e: "I don't have enough energy." },
    { t: "environment", m: "Ã§evre", y: "noun", e: "We must protect the environment." },
    { t: "equipment", m: "ekipman", y: "noun", e: "We need camping equipment." },
    { t: "evidence", m: "kanÄ±t", y: "noun", e: "There is no evidence of a crime." },
    { t: "experience", m: "tecrÃ¼be, deneyim", y: "noun", e: "She has 5 years of experience." },
    { t: "explanation", m: "aÃ§Ä±klama", y: "noun", e: "I need an explanation." },
    { t: "fact", m: "gerÃ§ek", y: "noun", e: "It is a scientific fact." },
    { t: "failure", m: "baÅŸarÄ±sÄ±zlÄ±k", y: "noun", e: "Failure is part of learning." },
    { t: "feature", m: "Ã¶zellik", y: "noun", e: "This phone has many new features." },
    { t: "feeling", m: "his", y: "noun", e: "I have a bad feeling about this." },
    { t: "freedom", m: "Ã¶zgÃ¼rlÃ¼k", y: "noun", e: "Freedom of speech." },
    { t: "goal", m: "hedef, amaÃ§", y: "noun", e: "My goal is to learn English." },
    { t: "government", m: "hÃ¼kÃ¼met", y: "noun", e: "The government lowered taxes." },
    { t: "growth", m: "bÃ¼yÃ¼me", y: "noun", e: "Population growth is rapid." },
    { t: "habit", m: "alÄ±ÅŸkanlÄ±k", y: "noun", e: "Smoking is a bad habit." },
    { t: "health", m: "saÄŸlÄ±k", y: "noun", e: "Health is wealth." },
    { t: "history", m: "tarih", y: "noun", e: "History repeats itself." },
    { t: "idea", m: "fikir", y: "noun", e: "I have a great idea." },
    { t: "importance", m: "Ã¶nem", y: "noun", e: "I understand the importance of time." },
    { t: "income", m: "gelir", y: "noun", e: "His income has increased." },
    { t: "industry", m: "sanayi, endÃ¼stri", y: "noun", e: "The car industry." },
    { t: "information", m: "bilgi", y: "noun", e: "For more information, visit our website." },
    { t: "injury", m: "yaralanma", y: "noun", e: "Luckily, it was a minor injury." },
    { t: "knowledge", m: "bilgi (birikim)", y: "noun", e: "Knowledge is power." },

    // --- ADJECTIVES (SÄ±fatlar) ---
    { t: "able", m: "yapabilir, muktedir", y: "adj", e: "Will you be able to come?" },
    { t: "actual", m: "gerÃ§ek, asÄ±l", y: "adj", e: "What is the actual cost?" },
    { t: "afraid", m: "korkmuÅŸ", y: "adj", e: "Are you afraid of spiders?" },
    { t: "alone", m: "yalnÄ±z", y: "adj", e: "I am home alone." },
    { t: "amazing", m: "ÅŸaÅŸÄ±rtÄ±cÄ±, harika", y: "adj", e: "The view was amazing." },
    { t: "angry", m: "kÄ±zgÄ±n", y: "adj", e: "Why are you angry?" },
    { t: "available", m: "mÃ¼sait, mevcut", y: "adj", e: "Is this seat available?" },
    { t: "basic", m: "temel", y: "adj", e: "Basic human rights." },
    { t: "beautiful", m: "gÃ¼zel", y: "adj", e: "A beautiful garden." },
    { t: "best", m: "en iyi", y: "adj", e: "She is my best friend." },
    { t: "better", m: "daha iyi", y: "adj", e: "I feel better today." },
    { t: "big", m: "bÃ¼yÃ¼k", y: "adj", e: "It's a big house." },
    { t: "boring", m: "sÄ±kÄ±cÄ±", y: "adj", e: "The movie was boring." },
    { t: "brave", m: "cesur", y: "adj", e: "He was a brave soldier." },
    { t: "bright", m: "parlak, zeki", y: "adj", e: "A bright future." },
    { t: "busy", m: "meÅŸgul", y: "adj", e: "I am very busy right now." },
    { t: "careful", m: "dikkatli", y: "adj", e: "Be careful driving." },
    { t: "cheap", m: "ucuz", y: "adj", e: "This shirt was very cheap." },
    { t: "clean", m: "temiz", y: "adj", e: "Keep your room clean." },
    { t: "clear", m: "aÃ§Ä±k, net", y: "adj", e: "The instructions are clear." },
    { t: "common", m: "yaygÄ±n, ortak", y: "adj", e: "It is a common mistake." },
    { t: "complex", m: "karmaÅŸÄ±k", y: "adj", e: "It is a complex problem." },
    { t: "concerned", m: "endiÅŸeli", y: "adj", e: "I am concerned about his health." },
    { t: "confident", m: "kendine gÃ¼venen", y: "adj", e: "She is confident she will win." },
    { t: "confused", m: "kafasÄ± karÄ±ÅŸmÄ±ÅŸ", y: "adj", e: "I am totally confused." },
    { t: "conscious", m: "bilinÃ§li", y: "adj", e: "He is conscious of his faults." },
    { t: "consistent", m: "tutarlÄ±", y: "adj", e: "We need consistent results." },
    { t: "constant", m: "sÃ¼rekli", y: "adj", e: "Constant noise makes me crazy." },
    { t: "crazy", m: "Ã§Ä±lgÄ±n, deli", y: "adj", e: "Are you crazy?" },
    { t: "creative", m: "yaratÄ±cÄ±", y: "adj", e: "She is very creative." },
    { t: "critical", m: "eleÅŸtirel, kritik", y: "adj", e: "It is a critical moment." },
    { t: "curious", m: "meraklÄ±", y: "adj", e: "I was curious to see it." },
    { t: "dangerous", m: "tehlikeli", y: "adj", e: "It is dangerous to swim here." },
    { t: "dark", m: "karanlÄ±k", y: "adj", e: "It gets dark early in winter." },
    { t: "deep", m: "derin", y: "adj", e: "The ocean is deep." },
    { t: "different", m: "farklÄ±", y: "adj", e: "We have different opinions." },
    { t: "difficult", m: "zor", y: "adj", e: "Math is difficult for me." },
    { t: "dirty", m: "kirli", y: "adj", e: "Your shoes are dirty." },
    { t: "disappointed", m: "hayal kÄ±rÄ±klÄ±ÄŸÄ±na uÄŸramÄ±ÅŸ", y: "adj", e: "I was disappointed with the service." },
    { t: "distinct", m: "belirgin, farklÄ±", y: "adj", e: "There is a distinct smell." },
    { t: "dramatic", m: "dramatik, Ã§arpÄ±cÄ±", y: "adj", e: "A dramatic change." },
    { t: "early", m: "erken", y: "adj", e: "I woke up early." },
    { t: "easy", m: "kolay", y: "adj", e: "The test was easy." },
    { t: "effective", m: "etkili", y: "adj", e: "This medicine is effective." },
    { t: "efficient", m: "verimli", y: "adj", e: "He is an efficient worker." },
    { t: "embarrassed", m: "utanmÄ±ÅŸ", y: "adj", e: "I felt embarrassed." },
    { t: "empty", m: "boÅŸ", y: "adj", e: "The glass is empty." },
    { t: "environmental", m: "Ã§evresel", y: "adj", e: "Environmental issues." },
    { t: "equal", m: "eÅŸit", y: "adj", e: "All men are created equal." },
    { t: "essential", m: "temel, elzem", y: "adj", e: "Water is essential for life." },
    { t: "exact", m: "tam, kesin", y: "adj", e: "Tell me the exact time." },
    { t: "excellent", m: "mÃ¼kemmel", y: "adj", e: "Excellent work!" },
    { t: "excited", m: "heyecanlÄ±", y: "adj", e: "I am excited about the trip." },
    { t: "expensive", m: "pahalÄ±", y: "adj", e: "Cars are expensive." },
    { t: "external", m: "harici", y: "adj", e: "External hard drive." },
    { t: "extreme", m: "aÅŸÄ±rÄ±", y: "adj", e: "Extreme weather." },
    { t: "famous", m: "Ã¼nlÃ¼", y: "adj", e: "He is a famous actor." },
    { t: "fast", m: "hÄ±zlÄ±", y: "adj", e: "A fast car." },
    { t: "financial", m: "finansal", y: "adj", e: "Financial problems." },
    { t: "foreign", m: "yabancÄ±", y: "adj", e: "Foreign language." },
    { t: "formal", m: "resmi", y: "adj", e: "Formal dress code." },
    { t: "free", m: "Ã¶zgÃ¼r, bedava", y: "adj", e: "Are you free tonight?" },
    { t: "frequent", m: "sÄ±k", y: "adj", e: "Frequent flyer." },
    { t: "friendly", m: "arkadaÅŸ canlÄ±sÄ±", y: "adj", e: "A friendly dog." },
    { t: "full", m: "dolu, tok", y: "adj", e: "I am full." },
    { t: "funny", m: "komik", y: "adj", e: "He is very funny." },
    { t: "general", m: "genel", y: "adj", e: "In general, I agree." },
    { t: "global", m: "kÃ¼resel", y: "adj", e: "Global warming." },
    { t: "good", m: "iyi", y: "adj", e: "Have a good day." },
    { t: "great", m: "harika, bÃ¼yÃ¼k", y: "adj", e: "It was a great party." },
    { t: "guilty", m: "suÃ§lu", y: "adj", e: "He feels guilty." },
    { t: "happy", m: "mutlu", y: "adj", e: "A happy family." },
    { t: "hard", m: "zor, sert", y: "adj", e: "The ground is hard." },
    { t: "healthy", m: "saÄŸlÄ±klÄ±", y: "adj", e: "Healthy food." },
    { t: "heavy", m: "aÄŸÄ±r", y: "adj", e: "This bag is heavy." },
    { t: "helpful", m: "yardÄ±msever", y: "adj", e: "The staff was helpful." },
    { t: "historical", m: "tarihi", y: "adj", e: "A historical building." },
    { t: "honest", m: "dÃ¼rÃ¼st", y: "adj", e: "Be honest with me." },
    { t: "hot", m: "sÄ±cak", y: "adj", e: "It is hot today." },
    { t: "huge", m: "kocaman", y: "adj", e: "A huge mistake." },
    { t: "human", m: "insani", y: "adj", e: "Human rights." },
    { t: "hungry", m: "aÃ§", y: "adj", e: "I am hungry." },
    { t: "illegal", m: "yasadÄ±ÅŸÄ±", y: "adj", e: "It is illegal to park here." },
    { t: "important", m: "Ã¶nemli", y: "adj", e: "This is very important." },
    { t: "impossible", m: "imkansÄ±z", y: "adj", e: "Nothing is impossible." }
    
  ];

  state.cards = starterPack.map(w => ({
    id: uid(),
    lang: "EN",
    term: w.t,
    meaning: w.m,
    type: w.y,
    example: w.e,
    note: "BaÅŸlangÄ±Ã§ Paketi",
    due: now(), 
    srs: { interval: 0, reps: 0, ef: 2.5 },
    createdAt: now(),
    updatedAt: now()
  }));

  saveAll();
  console.log("BaÅŸlangÄ±Ã§ paketi (200+ Kelime) yÃ¼klendi.");
}
/* ===========================
   Init
=========================== */
setTheme(state.settings.theme || "dark");
syncQuizModeLabels();
renderDash(); renderReview(); renderCards();
if(!state.reviewQueue) state.reviewQueue=[];
  /* ===========================
   EKSTRA KELÄ°ME PAKETÄ° (Mevcut listenin Ã¼zerine ekleme yapar)
   Ã–ncekileri silmez, sadece olmayanlarÄ± ekler.
=========================== */
(function addExtraWords() {
  const extraPack = [
    // --- YENÄ° FÄ°Ä°LLER (VERBS) ---
    { t: "apply", m: "baÅŸvurmak, uygulamak", y: "verb", e: "I applied for the job." },
    { t: "break", m: "kÄ±rmak, bozmak", y: "verb", e: "Don't break the glass." },
    { t: "build", m: "inÅŸa etmek", y: "verb", e: "They are building a new house." },
    { t: "buy", m: "satÄ±n almak", y: "verb", e: "I want to buy a car." },
    { t: "care", m: "Ã¶nemsemek, ilgilenmek", y: "verb", e: "I don't care about money." },
    { t: "catch", m: "yakalamak", y: "verb", e: "Catch the ball!" },
    { t: "change", m: "deÄŸiÅŸtirmek", y: "verb", e: "You haven't changed at all." },
    { t: "check", m: "kontrol etmek", y: "verb", e: "Please check your answers." },
    { t: "choose", m: "seÃ§mek", y: "verb", e: "Choose a color." },
    { t: "close", m: "kapatmak", y: "verb", e: "Close the door, please." },
    { t: "communicate", m: "iletiÅŸim kurmak", y: "verb", e: "We communicate by email." },
    { t: "complete", m: "tamamlamak", y: "verb", e: "Complete the sentence." },
    { t: "connect", m: "baÄŸlamak, baÄŸlanmak", y: "verb", e: "Connect to the internet." },
    { t: "control", m: "kontrol etmek, yÃ¶netmek", y: "verb", e: "He can't control his anger." },
    { t: "cook", m: "piÅŸirmek", y: "verb", e: "My mom cooks delicious food." },
    { t: "cost", m: "mal olmak (fiyat)", y: "verb", e: "How much does it cost?" },
    { t: "count", m: "saymak", y: "verb", e: "Can you count to ten?" },
    { t: "cover", m: "Ã¶rtmek, kaplamak", y: "verb", e: "Snow covered the ground." },
    { t: "cry", m: "aÄŸlamak", y: "verb", e: "Don't cry, be happy." },
    { t: "cut", m: "kesmek", y: "verb", e: "Cut the paper." },
    { t: "dance", m: "dans etmek", y: "verb", e: "Do you like to dance?" },
    { t: "deal", m: "uÄŸraÅŸmak, anlaÅŸmak", y: "verb", e: "I can't deal with this problem." },
    { t: "depend", m: "baÄŸlÄ± olmak", y: "verb", e: "It depends on the weather." },
    { t: "design", m: "tasarlamak", y: "verb", e: "Who designed this building?" },
    { t: "destroy", m: "yok etmek", y: "verb", e: "Fire destroyed the house." },

    // --- YENÄ° Ä°SÄ°MLER (NOUNS) ---
    { t: "action", m: "eylem, aksiyon", y: "noun", e: "Take action now." },
    { t: "activity", m: "aktivite", y: "noun", e: "Outdoor activities." },
    { t: "age", m: "yaÅŸ, Ã§aÄŸ", y: "noun", e: "What is your age?" },
    { t: "air", m: "hava", y: "noun", e: "Fresh air." },
    { t: "answer", m: "cevap", y: "noun", e: "I need an answer." },
    { t: "area", m: "alan, bÃ¶lge", y: "noun", e: "This is a restricted area." },
    { t: "art", m: "sanat", y: "noun", e: "Modern art." },
    { t: "bed", m: "yatak", y: "noun", e: "Time to go to bed." },
    { t: "blood", m: "kan", y: "noun", e: "Blood type." },
    { t: "body", m: "vÃ¼cut", y: "noun", e: "Human body." },
    { t: "book", m: "kitap", y: "noun", e: "Read a book." },
    { t: "box", m: "kutu", y: "noun", e: "What is in the box?" },
    { t: "boy", m: "erkek Ã§ocuk", y: "noun", e: "He is a good boy." },
    { t: "business", m: "iÅŸ, iÅŸletme", y: "noun", e: "Business trip." },
    { t: "car", m: "araba", y: "noun", e: "A fast car." },
    { t: "case", m: "durum, vaka", y: "noun", e: "In that case, I agree." },
    { t: "center", m: "merkez", y: "noun", e: "City center." },
    { t: "change", m: "deÄŸiÅŸim, para Ã¼stÃ¼", y: "noun", e: "Keep the change." },
    { t: "city", m: "ÅŸehir", y: "noun", e: "New York is a big city." },
    { t: "class", m: "sÄ±nÄ±f, ders", y: "noun", e: "History class." },
    { t: "color", m: "renk", y: "noun", e: "What is your favorite color?" },
    { t: "company", m: "ÅŸirket", y: "noun", e: "A tech company." },
    { t: "country", m: "Ã¼lke", y: "noun", e: "Which country are you from?" },
    { t: "day", m: "gÃ¼n", y: "noun", e: "Have a nice day." },
    { t: "death", m: "Ã¶lÃ¼m", y: "noun", e: "Life and death." },

    // --- YENÄ° SIFATLAR (ADJECTIVES) ---
    { t: "bad", m: "kÃ¶tÃ¼", y: "adj", e: "Bad weather." },
    { t: "big", m: "bÃ¼yÃ¼k", y: "adj", e: "A big house." },
    { t: "black", m: "siyah", y: "adj", e: "Black coffee." },
    { t: "blue", m: "mavi", y: "adj", e: "Blue sky." },
    { t: "certain", m: "kesin, belirli", y: "adj", e: "Are you certain?" },
    { t: "cold", m: "soÄŸuk", y: "adj", e: "It is cold outside." },
    { t: "cool", m: "serin, havalÄ±", y: "adj", e: "He is a cool guy." },
    { t: "current", m: "ÅŸu anki, mevcut", y: "adj", e: "Current situation." },
    { t: "dead", m: "Ã¶lÃ¼", y: "adj", e: "A dead tree." },
    { t: "dry", m: "kuru", y: "adj", e: "My throat is dry." },
    { t: "early", m: "erken", y: "adj", e: "Early morning." },
    { t: "fair", m: "adil", y: "adj", e: "That's not fair." },
    { t: "false", m: "yanlÄ±ÅŸ, sahte", y: "adj", e: "False information." },
    { t: "final", m: "son, nihai", y: "adj", e: "Final exam." },
    { t: "fine", m: "iyi, ince", y: "adj", e: "I am fine, thanks." },
    { t: "foreign", m: "yabancÄ±", y: "adj", e: "Foreign language." },
    { t: "future", m: "gelecek", y: "adj", e: "Future plans." },
    { t: "general", m: "genel", y: "adj", e: "General knowledge." },
    { t: "green", m: "yeÅŸil", y: "adj", e: "Green grass." },
    { t: "high", m: "yÃ¼ksek", y: "adj", e: "High prices." },
    { t: "human", m: "insani", y: "adj", e: "Human nature." },
    { t: "kind", m: "kibar", y: "adj", e: "Be kind to others." },
    { t: "large", m: "geniÅŸ, bÃ¼yÃ¼k", y: "adj", e: "A large pizza." },
    { t: "late", m: "geÃ§", y: "adj", e: "Don't be late." },
    { t: "left", m: "sol", y: "adj", e: "Turn left." }
  ];

  let addedCount = 0;
  extraPack.forEach(w => {
    // Kelime daha Ã¶nce var mÄ± diye kontrol et (bÃ¼yÃ¼k/kÃ¼Ã§Ã¼k harf duyarsÄ±z)
    const exists = state.cards.some(c => c.term.toLowerCase().trim() === w.t.toLowerCase().trim());
    
    // EÄŸer yoksa ekle
    if (!exists) {
      state.cards.push({
        id: uid(),
        lang: "EN",
        term: w.t,
        meaning: w.m,
        type: w.y,
        example: w.e,
        note: "Ekstra Paket",
        due: now(), 
        srs: { interval: 0, reps: 0, ef: 2.5 },
        createdAt: now(),
        updatedAt: now()
      });
      addedCount++;
    }
  });

  if (addedCount > 0) {
    saveAll();
    console.log(addedCount + " adet yeni kelime eklendi.");
    // EkranÄ± gÃ¼ncelle ki yeni kelimeler gÃ¶rÃ¼nsÃ¼n
    renderDash(); renderReview(); renderCards();
    toast(addedCount + " yeni kelime eklendi! ğŸš€");
  }
})();
/* ===========================
   TÃœRKÃ‡E -> Ä°NGÄ°LÄ°ZCE Ã‡EVÄ°RÄ° MOTORU
=========================== */
async function doQuickTranslateTR(){
  const input = document.getElementById("quickTransInputTR");
  // EÄŸer input yoksa hata vermesin
  if(!input) return;

  const term = input.value.trim();
  if(!term) return toast("LÃ¼tfen TÃ¼rkÃ§e kelime yazÄ±n");

  toast("Ã‡evriliyor... â³");

  // Google Translate API: Kaynak=TR, Hedef=EN
  const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=tr&tl=en&dt=t&dt=bd&q=${encodeURIComponent(term)}`;

  try{
    const r = await fetch(url);
    if(!r.ok) throw new Error("BaÄŸlantÄ± hatasÄ±");
    const data = await r.json();
    
    // Ana Ã‡eviri (Ä°ngilizcesi)
    let mainMean = (data?.[0]?.[0]?.[0] || "").trim();
    
    // DetaylÄ± Anlamlar (Varsa)
    let extraMeans = [];
    if(data[1]){
      data[1].forEach(group => {
        const pos = group[0]; // noun, verb vs.
        const words = group[1].slice(0, 4).join(", "); 
        extraMeans.push(`[${pos}]: ${words}`);
      });
    }

    // SonuÃ§ Penceresi Ä°Ã§eriÄŸi
    let content = `
      <div style="font-size:24px; font-weight:900; color:var(--warn); text-align:center;">${term}</div>
      <div style="font-size:32px; margin-top:10px; text-align:center; color:var(--text);">ğŸ‡¬ğŸ‡§ ${mainMean}</div>
    `;
    
    if(extraMeans.length > 0){
        content += `<div style="margin-top:15px; padding:10px; background:var(--card2); border-radius:8px; font-size:14px; color:var(--muted);">${extraMeans.join("<br>")}</div>`;
    }

    document.getElementById("trResContent").innerHTML = content;
    
    // Karta Ekleme HafÄ±zasÄ±:
    // KullanÄ±cÄ± TÃ¼rkÃ§e arattÄ± ama karta eklerken Ä°ngilizcesini "Term" (Ã–n yÃ¼z) yapacaÄŸÄ±z.
    quickTermCache = mainMean; 
    
    openSheet("transResultSheet"); // Pencereyi aÃ§
    input.value = ""; // Kutuyu temizle

  } catch(e){ 
    console.log(e);
    toast("Ã‡eviri yapÄ±lamadÄ±"); 
  }
}
</script>
</body>
</html>
